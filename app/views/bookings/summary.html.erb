
<%  @page_title = "Table Order" %>

<!-- Conditional formatting of the tab buttons -->
<% content_for(:tab_table_class, "tab_table_active") %>
<!-- end -->


<%#= show div with people yet to place order %>
<div class="card-orders">
  <% if @orders_not_sent_to_kitchen %>
    <% @orders_not_sent_to_kitchen.each do |order| %>
  <div class="card-order-container card-box-shadow">

      <div class="card-small card-order">
        <div class="card-medium-content">
          <strong> <%= order.dish.name %></strong>
          <div class="flex-between">
            <p>Quantity: 1</p>
            <p><%= humanized_money_with_symbol(order.dish.price) %></p>
          </div>
          <div>
            <p> Ordered by: <em><%= order.attendee.user.first_name %></em></p>
          </div>
        </div>
      </div>
  </div>

  <%#= button to change order statuses to 'ordered' %>
  <div class="button-area">
    <%= simple_form_for [@restaurant, @booking] do |f| %>
      <%= f.input :ordered, as: :hidden, value: true %>
      <%= f.submit "Place order with kitchen", class: "button button-long" %>
    <% end %>
  </div>

  <% end %>
  <% end %>
</div>






<%#= div with users that have placed their orders%>

<div class="card-orders">
  <% @orders_sent_to_kitchen.each do |order| %>
  <div class="card-order-container card-box-shadow">

      <div class="card-small card-order">
        <div class="card-medium-content">
          <strong> <%= order.dish.name %></strong>
          <div class="flex-between">
            <p>Quantity: 1</p>
            <p><%= humanized_money_with_symbol(order.dish.price) %></p>
          </div>
          <div>
            <p> Ordered by: <em><%= order.attendee.user.first_name %></em></p>
          </div>
        </div>
      </div>
  </div>
  <% end %>
</div>



  <% if @orders_sent_to_kitchen %>

    <%= form_tag restaurant_booking_pay_path(@restaurant, @booking) do %>
    <article>
        <label class="amount">
          <h2><span>Amount: <strong><%= humanized_money_with_symbol(@order_total.to_f) %></span></h2></label></strong>
    </article>

    <script src="https://checkout.stripe.com/checkout.js" class="stripe-button"
      data-key="<%= Rails.configuration.stripe[:publishable_key] %>"
      data-name="Table bill"
      data-email="<%= current_user.email %>"
      data-description="Pay Your Bill"
      data-amount="<%= @order_total * 100 %>"
      data-currency="GBP"></script>


    <% end %>

  <% else %>

    <%= simple_form_for [@restaurant, @booking] do |f| %>
      <%= f.input :ordered, as: :hidden, value: true %>
      <%= f.submit "Place table order", class: "button button-long" %>

      <% end %>

  <% end %>

</div>








